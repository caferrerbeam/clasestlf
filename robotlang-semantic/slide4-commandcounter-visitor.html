<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Slide 4: CommandCounterVisitor - Implementaci√≥n | Universidad EAM</title>
    <link rel="stylesheet" href="css/style.css">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism-tomorrow.min.css" rel="stylesheet" />
    <script src="https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.min.js"></script>
    <style>
        .slide-header {
            background: linear-gradient(135deg, #10b981 0%, #047857 100%);
            color: white;
            padding: 2rem;
            border-radius: 1rem;
            margin-bottom: 2rem;
        }

        .complete-solution-badge {
            background: linear-gradient(135deg, #fef3c7, #fde68a);
            border: 3px solid #f59e0b;
            padding: 1.5rem;
            border-radius: 1rem;
            margin: 2rem 0;
            text-align: center;
        }

        .code-with-line-annotations {
            position: relative;
            margin: 2rem 0;
        }

        .line-annotation {
            background: #eff6ff;
            border-left: 4px solid #3b82f6;
            padding: 1rem;
            margin: 1rem 0;
            border-radius: 0.5rem;
        }

        .state-tracker {
            background: #1e293b;
            color: #e2e8f0;
            padding: 1.5rem;
            border-radius: 0.75rem;
            font-family: var(--font-mono);
            margin: 1.5rem 0;
        }

        .state-value {
            color: #10b981;
            font-weight: 600;
        }

        .execution-trace {
            background: #f8fafc;
            border: 2px solid #e2e8f0;
            border-radius: 0.75rem;
            padding: 1.5rem;
            margin: 2rem 0;
        }

        .trace-step {
            background: white;
            border-left: 4px solid #10b981;
            padding: 1rem;
            margin: 1rem 0;
            border-radius: 0.5rem;
            position: relative;
            padding-left: 3rem;
        }

        .trace-step::before {
            content: "‚ñ∂";
            position: absolute;
            left: 1rem;
            color: #10b981;
            font-weight: bold;
        }

        .method-focus {
            background: linear-gradient(135deg, #dbeafe 0%, #bfdbfe 100%);
            border: 2px solid #3b82f6;
            padding: 2rem;
            border-radius: 1rem;
            margin: 2rem 0;
        }

        .recursion-diagram {
            background: white;
            padding: 2rem;
            border-radius: 0.75rem;
            margin: 2rem 0;
        }

        .purpose-card {
            background: linear-gradient(135deg, #f0fdf4 0%, #dcfce7 100%);
            border-left: 4px solid #10b981;
            padding: 2rem;
            border-radius: 0.75rem;
            margin: 2rem 0;
        }

        .use-case-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 1.5rem;
            margin: 1.5rem 0;
        }

        .use-case-card {
            background: white;
            padding: 1.5rem;
            border-radius: 0.75rem;
            border-left: 4px solid var(--secondary-green);
            box-shadow: var(--shadow-sm);
        }

        .counter-visualization {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 1rem;
            margin: 1.5rem 0;
        }

        .counter-box {
            background: linear-gradient(135deg, #eff6ff, #dbeafe);
            padding: 1rem;
            border-radius: 0.5rem;
            text-align: center;
            border: 2px solid #3b82f6;
        }

        .counter-label {
            font-size: 0.875rem;
            color: var(--text-secondary);
            margin-bottom: 0.5rem;
        }

        .counter-value {
            font-size: 2rem;
            font-weight: 700;
            color: #3b82f6;
        }

        .pattern-highlight {
            background: #fef3c7;
            border: 2px dashed #f59e0b;
            padding: 1.5rem;
            border-radius: 0.75rem;
            margin: 1.5rem 0;
        }

        @media (max-width: 768px) {
            .use-case-grid {
                grid-template-columns: 1fr;
            }

            .counter-visualization {
                grid-template-columns: 1fr 1fr;
            }
        }
    </style>
</head>
<body>
    <header class="main-header">
        <div class="header-content">
            <div class="logo-section">
                <h1>üìä CommandCounterVisitor</h1>
                <p class="subtitle">Slide 4 - Implementaci√≥n Completa de un Visitor</p>
            </div>
            <div class="course-info">
                <a href="index.html" class="btn" style="background: white; color: var(--primary-blue);">‚Üê Volver al √çndice</a>
            </div>
        </div>
    </header>

    <main class="main-content" style="max-width: 1200px; margin: 0 auto;">
        <div class="slide-header">
            <div class="slide-number">SLIDE 4 DE 7</div>
            <h2>CommandCounterVisitor - Soluci√≥n Completa</h2>
            <p style="margin-top: 0.5rem; font-size: 1.1rem;">
                Aprende a implementar un visitor funcional paso a paso
            </p>
        </div>

        <div class="complete-solution-badge">
            <h3 style="color: #f59e0b; margin-bottom: 0.5rem;">‚ö†Ô∏è SOLUCI√ìN COMPLETA INCLUIDA</h3>
            <p style="color: var(--text-secondary); margin: 0;">
                Este slide muestra el c√≥digo completo y detallado del CommandCounterVisitor.
                Estudia cada secci√≥n con atenci√≥n para entender c√≥mo implementar un visitor.
            </p>
        </div>

        <!-- Ubicaci√≥n del archivo -->
        <div style="background: linear-gradient(135deg, #dbeafe 0%, #bfdbfe 100%); border-left: 4px solid #3b82f6; padding: 1.5rem; border-radius: 0.75rem; margin: 2rem 0;">
            <h4 style="color: #1e40af; margin-bottom: 1rem; display: flex; align-items: center; gap: 0.5rem;">
                üìÅ Ubicaci√≥n en el Proyecto
            </h4>
            <p style="margin: 0; color: var(--text-secondary);">
                Revisa la implementaci√≥n completa en:
            </p>
            <pre style="background: #1e293b; color: #10b981; padding: 1rem; border-radius: 0.5rem; margin-top: 1rem; font-family: var(--font-mono); font-size: 0.95rem;"><code>src/main/java/semantic/statistics/CommandCounterVisitor.java</code></pre>
            <p style="margin-top: 1rem; color: var(--text-secondary); font-size: 0.9rem;">
                üí° <strong>Tip:</strong> Abre este archivo en tu IDE para seguir las explicaciones mientras lees el slide.
            </p>
        </div>

        <!-- Prop√≥sito -->
        <div class="content-section">
            <h3>üéØ Prop√≥sito del CommandCounterVisitor</h3>

            <div class="purpose-card">
                <h4 style="color: #047857;">¬øQu√© hace este visitor?</h4>
                <p style="font-size: 1.1rem; margin-top: 1rem;">
                    El <code>CommandCounterVisitor</code> <strong>recorre el AST completo</strong> y
                    <strong>cuenta cu√°ntas veces se usa cada comando del robot</strong> (UP, DOWN, LEFT, RIGHT, PENUP, PENDOWN).
                </p>
                <p style="margin-top: 1rem;">
                    Es √∫til para:
                </p>
                <ul style="line-height: 1.8; margin-top: 0.5rem;">
                    <li>An√°lisis de complejidad del programa</li>
                    <li>Estad√≠sticas de uso de comandos</li>
                    <li>Optimizaci√≥n de trayectorias del robot</li>
                    <li>Debugging y visualizaci√≥n</li>
                </ul>
            </div>

            <h4 style="margin-top: 2rem;">Casos de Uso Pr√°cticos:</h4>
            <div class="use-case-grid">
                <div class="use-case-card">
                    <h5>üìà An√°lisis de Programas</h5>
                    <p>Determinar la complejidad de un programa bas√°ndose en el n√∫mero de comandos ejecutados.</p>
                </div>

                <div class="use-case-card">
                    <h5>üèÜ Gamificaci√≥n</h5>
                    <p>Mostrar estad√≠sticas al usuario: "Tu programa usa 45 movimientos. ¬øPuedes optimizarlo?"</p>
                </div>

                <div class="use-case-card">
                    <h5>üîç Debugging</h5>
                    <p>Verificar que el programa genera el n√∫mero esperado de comandos.</p>
                </div>

                <div class="use-case-card">
                    <h5>üìä M√©tricas</h5>
                    <p>Generar reportes de uso para analizar patrones de programaci√≥n.</p>
                </div>
            </div>
        </div>

        <!-- Estructura de la Clase -->
        <div class="content-section">
            <h3>üèóÔ∏è Estructura de la Clase</h3>
            <p>
                Primero, veamos la estructura completa de la clase y sus componentes:
            </p>

            <pre><code class="language-java">public class CommandCounterVisitor implements ASTVisitor&lt;Void&gt; {

    // ========== ESTADO INTERNO - Contadores ==========
    private int upCommands = 0;
    private int downCommands = 0;
    private int leftCommands = 0;
    private int rightCommands = 0;
    private int penUpCommands = 0;
    private int penDownCommands = 0;

    // Contadores totales
    private int totalMovementCommands = 0;
    private int totalPenCommands = 0;

    // ========== M√âTODO PRINCIPAL ==========
    public void analyze(ASTNode root) {
        resetCounters();
        if (root != null) {
            root.accept(this);
        }
    }

    // ========== M√âTODOS AUXILIARES ==========
    private void resetCounters() { /* ... */ }
    public void printReport() { /* ... */ }
    public String getReport() { /* ... */ }

    // ========== VISITOR METHODS ==========
    @Override
    public Void visitMovementCommand(MovementCommandNode node) { /* ... */ }
    @Override
    public Void visitPenCommand(PenCommandNode node) { /* ... */ }
    // ... m√°s m√©todos visit para navegaci√≥n ...
}</code></pre>

            <div class="line-annotation">
                <h5>üí° Observaciones Clave:</h5>
                <ol style="line-height: 1.8;">
                    <li><strong>Implementa <code>ASTVisitor&lt;Void&gt;</code>:</strong> No retorna nada (usa <code>Void</code>), solo acumula en sus contadores internos</li>
                    <li><strong>Estado interno:</strong> Variables privadas para cada tipo de comando</li>
                    <li><strong>M√©todo <code>analyze()</code>:</strong> Punto de entrada que inicia el recorrido</li>
                    <li><strong>M√©todos <code>visitXXX()</code>:</strong> L√≥gica espec√≠fica para cada tipo de nodo</li>
                </ol>
            </div>
        </div>

        <!-- Estado Interno -->
        <div class="content-section">
            <h3>üíæ Manejo del Estado Interno</h3>
            <p>
                El visitor mantiene contadores como variables de instancia. Veamos c√≥mo se definen:
            </p>

            <pre><code class="language-java">// Contadores por tipo de comando espec√≠fico
private int upCommands = 0;        // Cuenta comandos UP
private int downCommands = 0;      // Cuenta comandos DOWN
private int leftCommands = 0;      // Cuenta comandos LEFT
private int rightCommands = 0;     // Cuenta comandos RIGHT
private int penUpCommands = 0;     // Cuenta comandos PENUP
private int penDownCommands = 0;   // Cuenta comandos PENDOWN

// Contadores totales por categor√≠a
private int totalMovementCommands = 0;  // Suma de UP+DOWN+LEFT+RIGHT
private int totalPenCommands = 0;       // Suma de PENUP+PENDOWN</code></pre>

            <div class="pattern-highlight">
                <h4>üé® Patr√≥n de Dise√±o: Acumulador de Estado</h4>
                <p>
                    Este visitor usa el patr√≥n <strong>Acumulador</strong>: va acumulando informaci√≥n en
                    variables de instancia a medida que visita nodos. Cuando termina el recorrido,
                    el estado interno contiene los resultados completos.
                </p>
            </div>

            <h4 style="margin-top: 2rem;">Resetear Contadores:</h4>
            <pre><code class="language-java">private void resetCounters() {
    upCommands = 0;
    downCommands = 0;
    leftCommands = 0;
    rightCommands = 0;
    penUpCommands = 0;
    penDownCommands = 0;
    totalMovementCommands = 0;
    totalPenCommands = 0;
}</code></pre>
            <p>
                <strong>¬øPor qu√© resetear?</strong> Para poder reutilizar la misma instancia del visitor
                en m√∫ltiples an√°lisis sin contaminar resultados anteriores.
            </p>
        </div>

        <!-- M√©todo analyze() -->
        <div class="content-section">
            <h3>üöÄ M√©todo analyze() - Punto de Entrada</h3>

            <div class="method-focus">
                <pre><code class="language-java">/**
 * Analiza el AST y cuenta todos los comandos.
 *
 * @param root El nodo ra√≠z del AST
 */
public void analyze(ASTNode root) {
    // 1. Resetear contadores para an√°lisis limpio
    resetCounters();

    // 2. Iniciar el recorrido del √°rbol
    if (root != null) {
        root.accept(this);  // ‚Üê Inicia el patr√≥n Visitor
    }
}</code></pre>
            </div>

            <div class="line-annotation">
                <h5>¬øQu√© sucede en cada l√≠nea?</h5>
                <ol style="line-height: 2;">
                    <li><code>resetCounters();</code> - Limpia todos los contadores a cero</li>
                    <li><code>if (root != null)</code> - Validaci√≥n defensiva contra null</li>
                    <li><code>root.accept(this)</code> - <strong>¬°Aqu√≠ inicia la magia!</strong>
                        <ul style="margin-top: 0.5rem;">
                            <li>Pasa el visitor al nodo ra√≠z</li>
                            <li>El nodo llama a <code>visitXXX()</code> correspondiente</li>
                            <li>Se inicia el recorrido recursivo del √°rbol</li>
                        </ul>
                    </li>
                </ol>
            </div>
        </div>

        <!-- M√©todos visit Clave -->
        <div class="content-section">
            <h3>üîë M√©todos visit Clave - Implementaci√≥n Detallada</h3>

            <h4>1. visitMovementCommand() - Contar Comandos de Movimiento</h4>
            <div class="method-focus">
                <pre><code class="language-java">@Override
public Void visitMovementCommand(MovementCommandNode node) {
    // Obtener el tipo de comando del nodo
    String command = node.getCommand();

    if (command != null) {
        // Usar switch para determinar qu√© contador incrementar
        switch (command) {
            case "UP":
                upCommands++;      // Incrementar contador espec√≠fico
                break;
            case "DOWN":
                downCommands++;
                break;
            case "LEFT":
                leftCommands++;
                break;
            case "RIGHT":
                rightCommands++;
                break;
        }
        // Incrementar el total de movimientos
        totalMovementCommands++;
    }

    return null;  // ASTVisitor&lt;Void&gt; requiere retornar null
}</code></pre>
            </div>

            <div class="line-annotation">
                <h5>üîç An√°lisis L√≠nea por L√≠nea:</h5>
                <ul style="line-height: 2;">
                    <li><code>String command = node.getCommand();</code>
                        <br>‚Üí Obtiene el tipo de comando ("UP", "DOWN", etc.) del nodo
                    </li>
                    <li><code>switch (command)</code>
                        <br>‚Üí Determina qu√© contador incrementar bas√°ndose en el comando
                    </li>
                    <li><code>upCommands++;</code>
                        <br>‚Üí Incrementa el contador espec√≠fico del comando
                    </li>
                    <li><code>totalMovementCommands++;</code>
                        <br>‚Üí Incrementa el contador total (independiente del tipo)
                    </li>
                    <li><code>return null;</code>
                        <br>‚Üí Requerido por <code>ASTVisitor&lt;Void&gt;</code>
                    </li>
                </ul>
            </div>

            <h4 style="margin-top: 2.5rem;">2. visitPenCommand() - Contar Comandos de Pluma</h4>
            <div class="method-focus">
                <pre><code class="language-java">@Override
public Void visitPenCommand(PenCommandNode node) {
    // Obtener el tipo de comando de pluma
    String command = node.getCommand();

    if (command != null) {
        switch (command) {
            case "PENUP":
                penUpCommands++;
                break;
            case "PENDOWN":
                penDownCommands++;
                break;
        }
        // Incrementar el total de comandos de pluma
        totalPenCommands++;
    }

    return null;
}</code></pre>
            </div>

            <p style="margin-top: 1rem;">
                <strong>Nota:</strong> La l√≥gica es id√©ntica a <code>visitMovementCommand()</code>,
                pero opera sobre comandos de pluma. Este patr√≥n se repite: cada tipo de nodo relevante
                tiene su propia l√≥gica de conteo.
            </p>

            <h4 style="margin-top: 2.5rem;">3. visitRepeatStatement() - Navegaci√≥n Recursiva</h4>
            <div class="method-focus">
                <pre><code class="language-java">@Override
public Void visitRepeatStatement(RepeatStatementNode node) {
    // Visitar recursivamente todos los hijos del REPEAT
    for (ASTNode child : node.getChildren()) {
        child.accept(this);  // ‚Üê Recursi√≥n
    }
    return null;
}</code></pre>
            </div>

            <div class="pattern-highlight">
                <h4>üé® Patr√≥n de Recursi√≥n</h4>
                <p>
                    Este m√©todo <strong>no cuenta nada</strong>. Solo propaga la visita a los hijos.
                    ¬øPor qu√©? Porque el <code>RepeatStatementNode</code> en s√≠ no es un comando contable.
                    Lo que nos interesa son los comandos <strong>dentro</strong> del REPEAT.
                </p>
                <p style="margin-top: 1rem;">
                    Al llamar <code>child.accept(this)</code>, cada hijo llamar√° a su m√©todo <code>visitXXX()</code>
                    correspondiente. Si el hijo es un <code>MovementCommandNode</code>, se llamar√°
                    <code>visitMovementCommand()</code> y se incrementar√° el contador.
                </p>
            </div>
        </div>

        <!-- Patr√≥n de Recursi√≥n -->
        <div class="content-section">
            <h3>üîÑ El Patr√≥n de Recursi√≥n</h3>
            <p>
                La mayor√≠a de los m√©todos <code>visitXXX()</code> simplemente propagan la visita a sus hijos:
            </p>

            <pre><code class="language-java">// Patr√≥n est√°ndar de navegaci√≥n
@Override
public Void visitStatementList(StatementListNode node) {
    for (ASTNode child : node.getChildren()) {
        child.accept(this);
    }
    return null;
}

@Override
public Void visitIfStatement(IfStatementNode node) {
    for (ASTNode child : node.getChildren()) {
        child.accept(this);
    }
    return null;
}

@Override
public Void visitWhileStatement(WhileStatementNode node) {
    for (ASTNode child : node.getChildren()) {
        child.accept(this);
    }
    return null;
}

// ... y as√≠ sucesivamente para todos los nodos "contenedores"</code></pre>

            <div class="recursion-diagram">
                <h4 style="margin-bottom: 1.5rem;">Diagrama de Recursi√≥n:</h4>
                <div class="mermaid">
graph TD
    Program[visitProgram] -->|Visita hijos| StmtList[visitStatementList]
    StmtList -->|Visita hijo 1| Repeat[visitRepeatStatement]
    StmtList -->|Visita hijo 2| Down[visitMovementCommand<br/>DOWN]

    Repeat -->|Visita hijo| Block[visitStatementBlock]
    Block -->|Visita hijo 1| Up[visitMovementCommand<br/>UP]
    Block -->|Visita hijo 2| Right[visitMovementCommand<br/>RIGHT]

    Up -.->|upCommands++| Counter1[Incrementa contador]
    Right -.->|rightCommands++| Counter2[Incrementa contador]
    Down -.->|downCommands++| Counter3[Incrementa contador]

    style Program fill:#8b5cf6,color:#fff
    style Repeat fill:#3b82f6,color:#fff
    style Up fill:#10b981,color:#fff
    style Right fill:#10b981,color:#fff
    style Down fill:#10b981,color:#fff
    style Counter1 fill:#fde68a
    style Counter2 fill:#fde68a
    style Counter3 fill:#fde68a
                </div>
            </div>
        </div>

        <!-- Ejemplo de Ejecuci√≥n Completo -->
        <div class="content-section">
            <h3>üé¨ Ejemplo de Ejecuci√≥n Completa</h3>

            <h4>Programa RoboLang:</h4>
            <pre><code class="language-robolang">REPEAT 2 {
    UP;
    RIGHT;
}
DOWN;
PENUP;</code></pre>

            <h4 style="margin-top: 2rem;">Traza de Ejecuci√≥n:</h4>
            <div class="execution-trace">
                <div class="trace-step">
                    <strong>1. analyze(programNode)</strong> ‚Üí Resetea contadores
                    <div class="state-tracker">
upCommands: <span class="state-value">0</span>  rightCommands: <span class="state-value">0</span>  downCommands: <span class="state-value">0</span>  penUpCommands: <span class="state-value">0</span>
                    </div>
                </div>

                <div class="trace-step">
                    <strong>2. programNode.accept(visitor)</strong> ‚Üí Llama visitProgram()
                    <br><small>visitProgram() visita todos los hijos del programa</small>
                </div>

                <div class="trace-step">
                    <strong>3. Encuentra RepeatStatementNode</strong> ‚Üí Llama visitRepeatStatement()
                    <br><small>visitRepeatStatement() visita el bloque de statements</small>
                </div>

                <div class="trace-step">
                    <strong>4. Primer hijo del REPEAT: MovementCommandNode("UP")</strong> ‚Üí visitMovementCommand()
                    <br><small>Incrementa upCommands y totalMovementCommands</small>
                    <div class="state-tracker">
upCommands: <span class="state-value">1</span>  totalMovementCommands: <span class="state-value">1</span>
                    </div>
                </div>

                <div class="trace-step">
                    <strong>5. Segundo hijo del REPEAT: MovementCommandNode("RIGHT")</strong> ‚Üí visitMovementCommand()
                    <br><small>Incrementa rightCommands y totalMovementCommands</small>
                    <div class="state-tracker">
upCommands: <span class="state-value">1</span>  rightCommands: <span class="state-value">1</span>  totalMovementCommands: <span class="state-value">2</span>
                    </div>
                </div>

                <div class="trace-step">
                    <strong>6. ‚ö†Ô∏è REPEAT 2 se ejecuta 2 veces ‚Üí Los pasos 4-5 se repiten</strong>
                    <div class="state-tracker">
upCommands: <span class="state-value">2</span>  rightCommands: <span class="state-value">2</span>  totalMovementCommands: <span class="state-value">4</span>
                    </div>
                </div>

                <div class="trace-step">
                    <strong>7. Fuera del REPEAT: MovementCommandNode("DOWN")</strong> ‚Üí visitMovementCommand()
                    <div class="state-tracker">
upCommands: <span class="state-value">2</span>  rightCommands: <span class="state-value">2</span>  downCommands: <span class="state-value">1</span>  totalMovementCommands: <span class="state-value">5</span>
                    </div>
                </div>

                <div class="trace-step">
                    <strong>8. PenCommandNode("PENUP")</strong> ‚Üí visitPenCommand()
                    <div class="state-tracker">
upCommands: <span class="state-value">2</span>  rightCommands: <span class="state-value">2</span>  downCommands: <span class="state-value">1</span>
penUpCommands: <span class="state-value">1</span>  totalPenCommands: <span class="state-value">1</span>
totalMovementCommands: <span class="state-value">5</span>
                    </div>
                </div>

                <div class="trace-step">
                    <strong>9. Recorrido completo ‚úì</strong>
                </div>
            </div>

            <h4 style="margin-top: 2rem;">Resultado Final:</h4>
            <div class="counter-visualization">
                <div class="counter-box">
                    <div class="counter-label">UP</div>
                    <div class="counter-value">2</div>
                </div>
                <div class="counter-box">
                    <div class="counter-label">DOWN</div>
                    <div class="counter-value">1</div>
                </div>
                <div class="counter-box">
                    <div class="counter-label">RIGHT</div>
                    <div class="counter-value">2</div>
                </div>
                <div class="counter-box">
                    <div class="counter-label">PENUP</div>
                    <div class="counter-value">1</div>
                </div>
                <div class="counter-box" style="grid-column: span 2;">
                    <div class="counter-label">TOTAL</div>
                    <div class="counter-value">6</div>
                </div>
            </div>
        </div>

        <!-- M√©todos de Reporte -->
        <div class="content-section">
            <h3>üìù M√©todos de Reporte</h3>
            <p>
                Una vez completado el recorrido, el visitor puede generar un reporte:
            </p>

            <pre><code class="language-java">public void printReport() {
    System.out.println("\n=== REPORTE DE COMANDOS ===\n");

    System.out.println("Comandos de Movimiento:");
    System.out.println("  UP:    " + upCommands);
    System.out.println("  DOWN:  " + downCommands);
    System.out.println("  LEFT:  " + leftCommands);
    System.out.println("  RIGHT: " + rightCommands);
    System.out.println("  Total: " + totalMovementCommands);

    System.out.println("\nComandos de Pluma:");
    System.out.println("  PENUP:   " + penUpCommands);
    System.out.println("  PENDOWN: " + penDownCommands);
    System.out.println("  Total:   " + totalPenCommands);

    System.out.println("\nTOTAL GENERAL: " +
                      (totalMovementCommands + totalPenCommands) + " comandos");
}</code></pre>

            <h4 style="margin-top: 2rem;">Uso Completo:</h4>
            <pre><code class="language-java">// 1. Crear el visitor
CommandCounterVisitor counter = new CommandCounterVisitor();

// 2. Analizar el AST
ProgramNode ast = parser.parse(tokens);
counter.analyze(ast);

// 3. Obtener resultados
counter.printReport();

// O acceder a contadores individuales
int totalMovimientos = counter.getTotalMovementCommands();
System.out.println("Total de movimientos: " + totalMovimientos);</code></pre>
        </div>

        <!-- Resumen -->
        <div class="content-section">
            <h3>üìö Resumen del Slide</h3>
            <div style="background: #f8fafc; padding: 1.5rem; border-radius: 0.75rem;">
                <h4>Has aprendido:</h4>
                <ul style="line-height: 1.8;">
                    <li>‚úÖ <strong>Prop√≥sito:</strong> CommandCounterVisitor cuenta comandos del robot en el AST</li>
                    <li>‚úÖ <strong>Estado interno:</strong> Usa variables de instancia como contadores acumuladores</li>
                    <li>‚úÖ <strong>M√©todo analyze():</strong> Resetea contadores e inicia recorrido con <code>root.accept(this)</code></li>
                    <li>‚úÖ <strong>visitMovementCommand():</strong> Incrementa contadores seg√∫n el tipo de comando</li>
                    <li>‚úÖ <strong>Patr√≥n de recursi√≥n:</strong> M√©todos visit propagan la visita a hijos con <code>child.accept(this)</code></li>
                    <li>‚úÖ <strong>Separaci√≥n de responsabilidades:</strong> Nodos de navegaci√≥n vs nodos de conteo</li>
                    <li>‚úÖ <strong>Reporte:</strong> M√©todos para obtener y mostrar resultados acumulados</li>
                </ul>

                <div class="highlight-box" style="margin-top: 1.5rem;">
                    <h4>üéØ Pr√≥ximo Paso</h4>
                    <p>
                        Ahora que entiendes c√≥mo se implementa un visitor completo,
                        en el siguiente slide tendr√°s la oportunidad de <strong>implementar tu propio visitor</strong>:
                        <code>SensorUsageVisitor</code>. Aplicar√°s todo lo aprendido en un ejercicio pr√°ctico guiado.
                    </p>
                </div>
            </div>
        </div>

        <!-- Navegaci√≥n -->
        <div class="navigation-buttons">
            <a href="slide3-visitor-pattern.html" class="btn" style="background: var(--text-secondary);">
                ‚Üê Anterior: Patr√≥n Visitor
            </a>
            <a href="slide5-sensorusage-exercise.html" class="btn btn-primary">
                Siguiente: Ejercicio SensorUsageVisitor ‚Üí
            </a>
        </div>
    </main>

    <footer style="text-align: center; padding: 2rem; background: var(--bg-dark); color: var(--text-white); margin-top: 3rem;">
        <p>Universidad EAM - Teor√≠a de Lenguajes Formales</p>
        <p style="margin-top: 0.5rem; font-size: 0.9rem; opacity: 0.8;">
            Slide 4: CommandCounterVisitor - Implementaci√≥n Completa
        </p>
    </footer>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-java.min.js"></script>
    <script>
        mermaid.initialize({
            startOnLoad: true,
            theme: 'default',
            themeVariables: {
                primaryColor: '#10b981',
                primaryTextColor: '#fff',
                primaryBorderColor: '#047857',
                lineColor: '#94a3b8',
                secondaryColor: '#3b82f6',
                tertiaryColor: '#8b5cf6'
            }
        });
    </script>
</body>
</html>
