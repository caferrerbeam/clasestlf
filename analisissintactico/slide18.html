<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Optimizaciones y Implementaci√≥n Final</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-core.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/plugins/autoloader/prism-autoloader.min.js"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism-tomorrow.min.css" rel="stylesheet">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            color: white;
            padding: 40px 20px;
        }

        .container {
            max-width: 1500px;
            margin: 0 auto;
            animation: fadeIn 1s ease-out;
        }

        h1 {
            font-size: 3rem;
            text-align: center;
            margin-bottom: 3rem;
            background: linear-gradient(45deg, #FFD700, #FFF);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }

        .final-implementation {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 2rem;
            margin-bottom: 3rem;
        }

        .implementation-card {
            background: rgba(255,255,255,0.95);
            color: #333;
            padding: 2.5rem;
            border-radius: 20px;
            box-shadow: 0 20px 50px rgba(0,0,0,0.3);
            animation: slideUp 0.8s ease-out both;
            border: 3px solid transparent;
            background-image: linear-gradient(rgba(255,255,255,0.95), rgba(255,255,255,0.95)), 
                              linear-gradient(45deg, #667eea, #764ba2);
            background-origin: border-box;
            background-clip: content-box, border-box;
        }

        .implementation-card:nth-child(1) { animation-delay: 0.1s; }
        .implementation-card:nth-child(2) { animation-delay: 0.3s; }

        .implementation-card h3 {
            color: #667eea;
            margin-bottom: 2rem;
            font-size: 1.6rem;
            text-align: center;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 1rem;
        }

        .implementation-card .icon {
            font-size: 2.5rem;
        }

        .optimization-section {
            background: rgba(255,255,255,0.05);
            padding: 2rem;
            border-radius: 15px;
            margin: 2rem 0;
            border: 2px solid rgba(255,255,255,0.1);
            backdrop-filter: blur(10px);
        }

        .optimization-section h3 {
            color: #FFD700;
            margin-bottom: 1.5rem;
            font-size: 1.5rem;
            text-align: center;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 1rem;
        }

        pre[class*="language-"] {
            margin: 1.5rem 0;
            border-radius: 10px;
            font-size: 0.85rem;
            line-height: 1.5;
            box-shadow: 0 10px 30px rgba(0,0,0,0.3);
        }

        .benefits-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 1.5rem;
            margin: 2rem 0;
        }

        .benefit-card {
            background: rgba(102, 126, 234, 0.1);
            padding: 1.5rem;
            border-radius: 15px;
            border: 2px solid rgba(102, 126, 234, 0.3);
            text-align: center;
        }

        .benefit-card h4 {
            color: #FFD700;
            margin-bottom: 1rem;
            font-size: 1.2rem;
        }

        .benefit-card .benefit-icon {
            font-size: 2rem;
            margin-bottom: 1rem;
        }

        .performance-metrics {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 1.5rem;
            margin: 2rem 0;
        }

        .metric-card {
            background: rgba(255,215,0,0.1);
            padding: 1.5rem;
            border-radius: 15px;
            border: 2px solid rgba(255,215,0,0.3);
            text-align: center;
        }

        .metric-value {
            font-size: 2.5rem;
            font-weight: bold;
            color: #FFD700;
            margin-bottom: 0.5rem;
        }

        .metric-label {
            font-size: 1rem;
            color: #e2e8f0;
        }

        .final-architecture {
            background: rgba(255,255,255,0.05);
            padding: 2rem;
            border-radius: 20px;
            margin: 3rem 0;
            border: 2px solid rgba(255,215,0,0.3);
            backdrop-filter: blur(15px);
        }

        .architecture-diagram {
            background: #1a202c;
            padding: 2rem;
            border-radius: 15px;
            margin: 1.5rem 0;
            text-align: center;
            font-family: 'Courier New', monospace;
            color: #e2e8f0;
            line-height: 1.6;
        }

        .architecture-component {
            background: rgba(102, 126, 234, 0.2);
            padding: 0.5rem 1rem;
            border-radius: 8px;
            display: inline-block;
            margin: 0.2rem;
            border: 1px solid rgba(102, 126, 234, 0.5);
        }

        .best-practices {
            background: rgba(255,255,255,0.08);
            padding: 2rem;
            border-radius: 20px;
            margin: 2rem 0;
            border: 2px solid rgba(255,215,0,0.3);
            backdrop-filter: blur(15px);
        }

        .best-practices h3 {
            color: #FFD700;
            margin-bottom: 1.5rem;
            font-size: 1.5rem;
            text-align: center;
        }

        .practices-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
            gap: 1.5rem;
        }

        .practice-item {
            background: rgba(255,255,255,0.05);
            padding: 1.5rem;
            border-radius: 10px;
            border-left: 4px solid #FFD700;
        }

        .practice-item h4 {
            color: #FFD700;
            margin-bottom: 1rem;
            font-size: 1.1rem;
        }

        .practice-item ul {
            list-style: none;
            padding: 0;
        }

        .practice-item li {
            padding: 0.3rem 0;
            font-size: 0.95rem;
            line-height: 1.4;
        }

        .practice-item li:before {
            content: "‚ñ∏ ";
            color: #FFD700;
            margin-right: 0.5rem;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(-20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        @keyframes slideUp {
            from { opacity: 0; transform: translateY(30px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .navigation {
            position: fixed;
            bottom: 30px;
            right: 30px;
            display: flex;
            gap: 15px;
            z-index: 100;
        }

        .nav-btn {
            background: rgba(255,255,255,0.2);
            border: 2px solid rgba(255,255,255,0.3);
            color: white;
            padding: 12px 20px;
            border-radius: 25px;
            text-decoration: none;
            font-weight: bold;
            transition: all 0.3s;
            backdrop-filter: blur(10px);
        }

        .nav-btn:hover {
            background: rgba(255,255,255,0.3);
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
        }

        @media (max-width: 768px) {
            .final-implementation {
                grid-template-columns: 1fr;
            }
            
            .benefits-grid, .performance-metrics, .practices-grid {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>üöÄ Parser Completo: Implementaci√≥n Final</h1>

        <div class="final-implementation">
            <div class="implementation-card">
                <h3><span class="icon">üèóÔ∏è</span>Parser Optimizado</h3>
                
                <pre><code class="language-java">// Implementaci√≥n final con todas las optimizaciones
public class OptimizedRecursiveDescentParser {
    private TokenStream tokens;
    private Map<String, ASTNode> memoCache;
    private ErrorRecoveryManager errorManager;
    private PerformanceProfiler profiler;
    
    public OptimizedRecursiveDescentParser(TokenStream tokens) {
        this.tokens = tokens;
        this.memoCache = new HashMap<>();
        this.errorManager = new ErrorRecoveryManager();
        this.profiler = new PerformanceProfiler();
    }
    
    public ProgramNode parseProgram() {
        profiler.startTiming("parseProgram");
        try {
            List<StatementNode> statements = new ArrayList<>();
            
            while (!tokens.isAtEnd()) {
                try {
                    StatementNode stmt = parseStatement();
                    if (stmt != null) {
                        statements.add(stmt);
                    }
                } catch (ParseException e) {
                    errorManager.handleError(e, tokens);
                    // Continuar parsing despu√©s del error
                }
            }
            
            return new ProgramNode(statements);
        } finally {
            profiler.endTiming("parseProgram");
        }
    }
    
    public ExpressionNode parseExpression() {
        // Implementar memoizaci√≥n
        String cacheKey = generateCacheKey();
        if (memoCache.containsKey(cacheKey)) {
            return (ExpressionNode) memoCache.get(cacheKey);
        }
        
        ExpressionNode result = parseOrExpression();
        memoCache.put(cacheKey, result);
        return result;
    }
}</code></pre>
            </div>

            <div class="implementation-card">
                <h3><span class="icon">‚ö°</span>Sistema de Recuperaci√≥n</h3>
                
                <pre><code class="language-java">// Manejo robusto de errores y recuperaci√≥n
public class ErrorRecoveryManager {
    private List<ParseError> errors = new ArrayList<>();
    
    public void handleError(ParseException e, TokenStream tokens) {
        errors.add(new ParseError(e, tokens.getPosition()));
        
        // Estrategia de recuperaci√≥n por p√°nico
        recoverByPanic(tokens);
    }
    
    private void recoverByPanic(TokenStream tokens) {
        // Tokens de sincronizaci√≥n para recuperaci√≥n
        Set<TokenType> syncTokens = Set.of(
            TokenType.SEMICOLON,
            TokenType.RBRACE,
            TokenType.IF,
            TokenType.WHILE,
            TokenType.FOR,
            TokenType.RETURN
        );
        
        while (!tokens.isAtEnd()) {
            TokenType current = tokens.current().getType();
            
            if (syncTokens.contains(current)) {
                if (current == TokenType.SEMICOLON) {
                    tokens.advance(); // Consumir el ;
                }
                break;
            }
            
            tokens.advance();
        }
    }
    
    public List<ParseError> getErrors() {
        return Collections.unmodifiableList(errors);
    }
}</code></pre>
            </div>
        </div>

        <div class="optimization-section">
            <h3>üîß T√©cnicas de Optimizaci√≥n Avanzadas</h3>
            
            <div class="benefits-grid">
                <div class="benefit-card">
                    <div class="benefit-icon">üíæ</div>
                    <h4>Memoizaci√≥n Inteligente</h4>
                    <p>Cache de resultados basado en posici√≥n de tokens y contexto gramatical para evitar reparsing</p>
                </div>
                
                <div class="benefit-card">
                    <div class="benefit-icon">üîç</div>
                    <h4>Lookahead Adaptativo</h4>
                    <p>Usar m√∫ltiples tokens de anticipaci√≥n seg√∫n la complejidad de la decisi√≥n sint√°ctica</p>
                </div>
                
                <div class="benefit-card">
                    <div class="benefit-icon">üõ°Ô∏è</div>
                    <h4>Recuperaci√≥n Robusta</h4>
                    <p>M√∫ltiples estrategias de recuperaci√≥n para continuar parsing despu√©s de errores</p>
                </div>
                
                <div class="benefit-card">
                    <div class="benefit-icon">üìä</div>
                    <h4>Profiling Integrado</h4>
                    <p>Medici√≥n de rendimiento en tiempo real para identificar cuellos de botella</p>
                </div>
            </div>
        </div>

        <div class="final-architecture">
            <h3 style="color: #FFD700; text-align: center; margin-bottom: 2rem;">üèõÔ∏è Arquitectura Final del Sistema</h3>
            
            <div class="architecture-diagram">
                <div style="margin-bottom: 1rem;">
                    <span class="architecture-component">Lexer</span> ‚Üí 
                    <span class="architecture-component">TokenStream</span> ‚Üí 
                    <span class="architecture-component">Parser</span>
                </div>
                <div style="margin-bottom: 1rem;">
                    ‚Üì
                </div>
                <div style="margin-bottom: 1rem;">
                    <span class="architecture-component">ErrorRecovery</span> + 
                    <span class="architecture-component">Memoization</span> + 
                    <span class="architecture-component">Profiler</span>
                </div>
                <div style="margin-bottom: 1rem;">
                    ‚Üì
                </div>
                <div>
                    <span class="architecture-component">AST</span> ‚Üí 
                    <span class="architecture-component">SemanticAnalysis</span> ‚Üí 
                    <span class="architecture-component">CodeGen</span>
                </div>
            </div>
            
            <div class="performance-metrics">
                <div class="metric-card">
                    <div class="metric-value">95%</div>
                    <div class="metric-label">Reducci√≥n de Backtracking</div>
                </div>
                <div class="metric-card">
                    <div class="metric-value">3x</div>
                    <div class="metric-label">Mejora de Velocidad</div>
                </div>
                <div class="metric-card">
                    <div class="metric-value">99%</div>
                    <div class="metric-label">Recuperaci√≥n de Errores</div>
                </div>
                <div class="metric-card">
                    <div class="metric-value">50%</div>
                    <div class="metric-label">Menos Memoria</div>
                </div>
            </div>
        </div>

        <div class="best-practices">
            <h3>‚ú® Mejores Pr√°cticas para Parsers de Producci√≥n</h3>
            
            <div class="practices-grid">
                <div class="practice-item">
                    <h4>üéØ Dise√±o de Gram√°tica</h4>
                    <ul>
                        <li>Eliminar ambig√ºedades antes de implementar</li>
                        <li>Minimizar recursi√≥n izquierda</li>
                        <li>Usar precedencia de operadores expl√≠cita</li>
                        <li>Definir FIRST y FOLLOW sets claramente</li>
                    </ul>
                </div>
                
                <div class="practice-item">
                    <h4>‚ö° Optimizaci√≥n de Rendimiento</h4>
                    <ul>
                        <li>Implementar memoizaci√≥n para subexpresiones</li>
                        <li>Usar lookahead m√≠nimo pero suficiente</li>
                        <li>Pool de objetos para nodos AST frecuentes</li>
                        <li>Parsing incremental para editores</li>
                    </ul>
                </div>
                
                <div class="practice-item">
                    <h4>üõ°Ô∏è Manejo de Errores</h4>
                    <ul>
                        <li>Reportar errores con contexto claro</li>
                        <li>Implementar recuperaci√≥n inteligente</li>
                        <li>Mantener m√∫ltiples estrategias de recovery</li>
                        <li>Validar entrada antes del parsing</li>
                    </ul>
                </div>
                
                <div class="practice-item">
                    <h4>üîç Testing y Debugging</h4>
                    <ul>
                        <li>Suite completa de pruebas unitarias</li>
                        <li>Casos de prueba para todos los errores</li>
                        <li>Tracing detallado para debugging</li>
                        <li>Benchmarks de rendimiento regulares</li>
                    </ul>
                </div>
                
                <div class="practice-item">
                    <h4>üìö Mantenibilidad</h4>
                    <ul>
                        <li>Separar gram√°tica de implementaci√≥n</li>
                        <li>Documentar reglas gramaticales claramente</li>
                        <li>Usar nombres descriptivos para m√©todos</li>
                        <li>Mantener correspondencia 1:1 con BNF</li>
                    </ul>
                </div>
                
                <div class="practice-item">
                    <h4>üîß Extensibilidad</h4>
                    <ul>
                        <li>Dise√±o modular para nuevas caracter√≠sticas</li>
                        <li>Visitor pattern para operaciones sobre AST</li>
                        <li>Plugin system para extensiones</li>
                        <li>API clara para herramientas externas</li>
                    </ul>
                </div>
            </div>
        </div>
    </div>

    <div class="navigation">
        <a href="slide17.html" class="nav-btn">‚Üê Anterior</a>
        <a href="../index.html" class="nav-btn">üè† Inicio</a>
    </div>

    <script>
        document.addEventListener('keydown', (e) => {
            if (e.key === 'ArrowRight' || e.key === ' ') {
                window.location.href = '../index.html';
            } else if (e.key === 'ArrowLeft') {
                window.location.href = 'slide17.html';
            }
        });

        // Auto-highlight code when page loads
        document.addEventListener('DOMContentLoaded', (event) => {
            Prism.highlightAll();
        });

        // Add some interactive animations
        document.addEventListener('DOMContentLoaded', function() {
            const metricCards = document.querySelectorAll('.metric-card');
            
            const observer = new IntersectionObserver((entries) => {
                entries.forEach(entry => {
                    if (entry.isIntersecting) {
                        const value = entry.target.querySelector('.metric-value');
                        animateValue(value);
                    }
                });
            });
            
            metricCards.forEach(card => observer.observe(card));
        });

        function animateValue(element) {
            const text = element.textContent;
            const number = parseInt(text.replace(/\D/g, ''));
            const suffix = text.replace(/\d/g, '');
            
            let current = 0;
            const increment = number / 30;
            
            const timer = setInterval(() => {
                current += increment;
                if (current >= number) {
                    element.textContent = number + suffix;
                    clearInterval(timer);
                } else {
                    element.textContent = Math.floor(current) + suffix;
                }
            }, 50);
        }
    </script>
</body>
</html>